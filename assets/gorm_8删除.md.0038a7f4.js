import{_ as s,c as n,o as a,a as l}from"./app.78cd51cb.js";const A=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":3,"title":"1.\u5220\u9664\u4E00\u6761\u8BB0\u5F55","slug":"_1-\u5220\u9664\u4E00\u6761\u8BB0\u5F55","link":"#_1-\u5220\u9664\u4E00\u6761\u8BB0\u5F55","children":[]},{"level":3,"title":"2.\u6839\u636E\u4E3B\u952E\u5220\u9664","slug":"_2-\u6839\u636E\u4E3B\u952E\u5220\u9664","link":"#_2-\u6839\u636E\u4E3B\u952E\u5220\u9664","children":[]},{"level":3,"title":"3.Delete Hook","slug":"_3-delete-hook","link":"#_3-delete-hook","children":[]},{"level":3,"title":"4.\u6279\u91CF\u5220\u9664","slug":"_4-\u6279\u91CF\u5220\u9664","link":"#_4-\u6279\u91CF\u5220\u9664","children":[]},{"level":3,"title":"5.\u963B\u6B62\u5168\u5C40\u5220\u9664","slug":"_5-\u963B\u6B62\u5168\u5C40\u5220\u9664","link":"#_5-\u963B\u6B62\u5168\u5C40\u5220\u9664","children":[]},{"level":3,"title":"6.\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E","slug":"_6-\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E","link":"#_6-\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E","children":[]},{"level":3,"title":"7.\u8F6F\u5220\u9664","slug":"_7-\u8F6F\u5220\u9664","link":"#_7-\u8F6F\u5220\u9664","children":[]},{"level":3,"title":"8.\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55","slug":"_8-\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55","link":"#_8-\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55","children":[]},{"level":3,"title":"9.\u6C38\u4E45\u5220\u9664","slug":"_9-\u6C38\u4E45\u5220\u9664","link":"#_9-\u6C38\u4E45\u5220\u9664","children":[]},{"level":3,"title":"10.Delete Flag","slug":"_10-delete-flag","link":"#_10-delete-flag","children":[]}],"relativePath":"gorm/8\u5220\u9664.md"}'),p={name:"gorm/8\u5220\u9664.md"},e=l(`<h3 id="_1-\u5220\u9664\u4E00\u6761\u8BB0\u5F55" tabindex="-1">1.\u5220\u9664\u4E00\u6761\u8BB0\u5F55 <a class="header-anchor" href="#_1-\u5220\u9664\u4E00\u6761\u8BB0\u5F55" aria-hidden="true">#</a></h3><ul><li>\u5220\u9664\u4E00\u6761\u8BB0\u5F55\u65F6\uFF0C\u5220\u9664\u5BF9\u8C61\u9700\u8981\u6307\u5B9A\u4E3B\u952E\uFF0C\u5426\u5219\u4F1A\u89E6\u53D1\u6279\u91CF<code>Delete</code>,\u4F8B\u5982:</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#676E95;">// Email \u7684 ID \u662F \`10\`</span></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">email</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE from emails WHERE id = 10;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u5E26\u989D\u5916\u6761\u4EF6\u7684\u5220\u9664</span></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name = ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jinzhu</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">emial</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM emails WHERE id = 10 AND name = &quot;jinzhu&quot;;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-\u6839\u636E\u4E3B\u952E\u5220\u9664" tabindex="-1">2.\u6839\u636E\u4E3B\u952E\u5220\u9664 <a class="header-anchor" href="#_2-\u6839\u636E\u4E3B\u952E\u5220\u9664" aria-hidden="true">#</a></h3><ul><li><code>GORM</code>\u5141\u8BB8\u901A\u8FC7\u4E3B\u952E(\u53EF\u4EE5\u662F\u590D\u5408\u4E3B\u952E)\u548C\u5185\u8054\u6761\u4EF6\u6765\u5220\u9664\u5BF9\u8C61\uFF0C\u5B83\u53EF\u4EE5\u4F7F\u7528\u6570\u5B57,\u4E5F\u53EF\u4EE5\u4F7F\u7528\u5B57\u7B26\u4E32</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM users WHERE id = 10;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">10</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM users WHERE id = 10;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#C792EA;">int</span><span style="color:#89DDFF;">{</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM users WHERE id IN (1,2,3);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-delete-hook" tabindex="-1">3.Delete Hook <a class="header-anchor" href="#_3-delete-hook" aria-hidden="true">#</a></h3><ul><li>\u5BF9\u4E8E\u5220\u9664\u64CD\u4F5C\uFF0C GORM \u652F\u6301<code>BeforeDelete</code>, <code>AfterDelete</code> Hook, \u5728\u5220\u9664\u8BB0\u5F55\u65F6\u4F1A\u8C03\u7528\u8FD9\u4E9B\u65B9\u6CD5</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#676E95;">// \u7ED9\u6A21\u578B\u52A0\u65B9\u6CD5\uFF0C\u5C31\u53EF\u4EE5\u7ED9\u4ED6\u52A0Hook</span></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">u </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">BerforeDelete</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">tx </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">)(</span><span style="color:#A6ACCD;">err </span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> u</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Role </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> errors</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">New</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin user not allowed to delete</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">return</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-\u6279\u91CF\u5220\u9664" tabindex="-1">4.\u6279\u91CF\u5220\u9664 <a class="header-anchor" href="#_4-\u6279\u91CF\u5220\u9664" aria-hidden="true">#</a></h3><ul><li>\u5982\u679C\u6307\u5B9A\u7684\u503C\u4E0D\u5305\u62EC\u4E3B\u5C5E\u6027\uFF0C\u90A3\u4E48 GORM \u4F1A\u6267\u884C\u6279\u91CF\u5220\u9664\uFF0C\u5B83\u5C06\u5220\u9664\u6240\u6709\u5339\u914D\u8BB0\u5F55</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">email LIKE ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%jinzhu%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">Email</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM emails WHERE email LIKE &quot;%jinzhu%&quot;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">Emial</span><span style="color:#89DDFF;">{},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">email LIKE ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%jinzhu%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-\u963B\u6B62\u5168\u5C40\u5220\u9664" tabindex="-1">5.\u963B\u6B62\u5168\u5C40\u5220\u9664 <a class="header-anchor" href="#_5-\u963B\u6B62\u5168\u5C40\u5220\u9664" aria-hidden="true">#</a></h3><ul><li>\u5982\u679C\u5728\u6CA1\u6709\u4EFB\u4F55\u6761\u4EF6\u7684\u60C5\u51B5\u4E0B\u6267\u884C\u6279\u91CF\u5220\u9664, GORM \u4E0D\u4F1A\u6267\u884C\u8BE5\u64CD\u4F5C\uFF0C\u5E76\u8FD4\u56DE<code>ErrMissingWhereClause</code>\u9519\u8BEF</li><li>\u5BF9\u6B64\uFF0C\u4F60\u5FC5\u987B\u52A0\u4E00\u4E9B\u6761\u4EF6\uFF0C\u6216\u8005\u4F7F\u7528\u539F\u751F SQL\uFF0C\u6216\u8005\u542F\u7528<code>AllowedGlobalUpdate</code>\u6A21\u5F0F\uFF0C\u4F8B\u5982</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{}).</span><span style="color:#A6ACCD;">Error  </span><span style="color:#676E95;">// gorm.ErrMissingWhereClause</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1 = 1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM \`users\` WHERE 1 = 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Exec</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">DELETE FROM users</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM users</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Session</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Session</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">AllowGlobalUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true)).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_6-\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E" tabindex="-1">6.\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E <a class="header-anchor" href="#_6-\u8FD4\u56DE\u5220\u9664\u884C\u7684\u6570\u636E" aria-hidden="true">#</a></h3><ul><li>\u8FD4\u56DE\u88AB\u5220\u9664\u7684\u6570\u636E\uFF0C\u4EC5\u9002\u7528\u4E8E\u652F\u6301 Returning \u7684\u6570\u636E\uFF0C\u4F8B\u5982:</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#676E95;">// \u8FD4\u56DE\u6240\u6709\u5217</span></span>
<span class="line"><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> users </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">User</span></span>
<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Clauses</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clauses</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Returning</span><span style="color:#89DDFF;">{}).</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">role = ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM \`users\` WHERE role = &quot;admin&quot; RETURNING *</span></span>
<span class="line"><span style="color:#676E95;">// users =&gt; []User{{ID: 1, Name: &quot;jinzhu&quot;, Role: &quot;admin&quot;, Salary: 100}, {ID: 2, Name: &quot;jinzhu.2&quot;, Role: &quot;admin&quot;, Salary: 1000}}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u8FD4\u56DE\u6307\u5B9A\u7684\u5217</span></span>
<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Clauses</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">clause</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Returning</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">Columns</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">clause</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Column</span><span style="color:#89DDFF;">{{</span><span style="color:#A6ACCD;">Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">salary</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}}}).</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">role = ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// DELETE FROM \`users\` WHERE role = &quot;admin&quot; RETURNING \`name\`, \`salary\`</span></span>
<span class="line"><span style="color:#676E95;">// users =&gt; []User{{ID: 0, Name: &quot;jinzhu&quot;, Role: &quot;&quot;, Salary: 100}, {ID: 0, Name: &quot;jinzhu.2&quot;, Role: &quot;&quot;, Salary: 1000}}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_7-\u8F6F\u5220\u9664" tabindex="-1">7.\u8F6F\u5220\u9664 <a class="header-anchor" href="#_7-\u8F6F\u5220\u9664" aria-hidden="true">#</a></h3><ul><li>\u5982\u679C\u4F60\u7684\u6A21\u578B\u5305\u542B\u4E86\u4E00\u4E2A<code>gorm.deletedat</code>\u5B57\u6BB5(<code>gorm.Model</code>\u5DF2\u7ECF\u5305\u542B\u4E86\u8BE5\u5B57\u6BB5)\uFF0C\u5B83\u5C06\u4F1A\u81EA\u52A8\u83B7\u5F97\u8F6F\u5220\u9664\u7684\u80FD\u529B</li><li>\u62E5\u6709\u8F6F\u5220\u9664\u80FD\u529B\u7684\u6A21\u578B\u8C03\u7528<code>Delete</code>\u65F6\uFF0C\u8BB0\u5F55\u4E0D\u4F1A\u4ECE\u6570\u636E\u5E93\u4E2D\u771F\u6B63\u5220\u9664\u3002\u4F46<code>GORM</code>\u4F1A\u5C06<code>DeletedAt</code>\u7F6E\u4E3A\u5F53\u524D\u65F6\u95F4\uFF0C\u5E76\u4E14\u4F60\u4E0D\u80FD\u518D\u901A\u8FC7\u666E\u901A\u7684\u67E5\u8BE2\u65B9\u6CD5\u627E\u5230\u8BE5\u8BB0\u5F55</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#676E95;">// user\u7684ID\u662F\`111\`</span></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// UPDATE users SET deleted_at = &quot;2013-10-29 10:23&quot; WHERE id = 111;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u6279\u91CF\u5220\u9664</span></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age = ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"><span style="color:#676E95;">// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE age = 20;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u5728\u67E5\u8BE2\u65F6\u4F1A\u5FFD\u7565\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</span></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age = 20</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Find</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>\u5982\u679C\u4F60\u4E0D\u60F3\u5F15\u5165<code>gorm.Model</code>,\u4F60\u4E5F\u53EF\u4EE5\u8FD9\u6837\u542F\u7528\u8F6F\u5220\u9664\u7279\u6027</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">User</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  ID      </span><span style="color:#C792EA;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">  Deleted gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DeletedAt</span></span>
<span class="line"><span style="color:#A6ACCD;">  Name    </span><span style="color:#C792EA;">string</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_8-\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55" tabindex="-1">8.\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55 <a class="header-anchor" href="#_8-\u67E5\u627E\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55" aria-hidden="true">#</a></h3><ul><li>\u4F60\u53EF\u4EE5\u4F7F\u7528<code>Unscoped</code>\u627E\u5230\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Unscoped</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age = 20</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Find</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;">// SELECT * FROM users  WHERE age = 20;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_9-\u6C38\u4E45\u5220\u9664" tabindex="-1">9.\u6C38\u4E45\u5220\u9664 <a class="header-anchor" href="#_9-\u6C38\u4E45\u5220\u9664" aria-hidden="true">#</a></h3><ul><li>\u60A8\u4E5F\u53EF\u4EE5\u4F7F\u7528<code>Unscoped</code>\u6C38\u4E45\u5220\u9664\u5339\u914D\u7684\u8BB0\u5F55</li></ul><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Unscoped</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">Delete</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">order</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_10-delete-flag" tabindex="-1">10.Delete Flag <a class="header-anchor" href="#_10-delete-flag" aria-hidden="true">#</a></h3>`,30),o=[e];function r(c,t,D,F,y,i){return a(),n("div",null,o)}const d=s(p,[["render",r]]);export{A as __pageData,d as default};
