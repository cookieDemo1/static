import{_ as s,c as n,o as a,a as l}from"./app.78cd51cb.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":3,"title":"DBResolver","slug":"dbresolver","link":"#dbresolver","children":[]},{"level":3,"title":"1.\u7528\u6CD5","slug":"_1-\u7528\u6CD5","link":"#_1-\u7528\u6CD5","children":[]}],"relativePath":"gorm/35DBResolver.md"}'),p={name:"gorm/35DBResolver.md"},o=l('<h3 id="dbresolver" tabindex="-1"><code>DBResolver</code> <a class="header-anchor" href="#dbresolver" aria-hidden="true">#</a></h3><ul><li><code>DBResolver</code>\u4E3A<code>GORM</code>\u63D0\u4F9B\u4E86\u591A\u4E2A\u6570\u636E\u5E93\u652F\u6301\uFF0C\u652F\u6301\u4EE5\u4E0B\u529F\u80FD</li></ul><h3 id="_1-\u7528\u6CD5" tabindex="-1">1.\u7528\u6CD5 <a class="header-anchor" href="#_1-\u7528\u6CD5" aria-hidden="true">#</a></h3><div class="language-go line-numbers-mode"><button class="copy"></button><span class="lang">go</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">gorm.io/gorm</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">gorm.io/plugin/dbresolver</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">gorm.io/driver/mysql</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#89DDFF;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> gorm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db1_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Config</span><span style="color:#89DDFF;">{})</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Use</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dbresolver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Register</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dbresolver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Config</span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// `db2` \u4F5C\u4E3A sources\uFF0C`db3`\u3001`db4` \u4F5C\u4E3A replicas</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Sources</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Dialector</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db2_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)},</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Dialector</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db3_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db4_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)},</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// sources/replicas \u8D1F\u8F7D\u5747\u8861\u7B56\u7565</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Policy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> dbresolver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">RandomPolicy</span><span style="color:#89DDFF;">{},</span></span>\n<span class="line"><span style="color:#89DDFF;">}).</span><span style="color:#82AAFF;">Register</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dbresolver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Config</span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// `db1` \u4F5C\u4E3A sources\uFF08DB \u7684\u9ED8\u8BA4\u8FDE\u63A5\uFF09\uFF0C\u5BF9\u4E8E `User`\u3001`Address` \u4F7F\u7528 `db5` \u4F5C\u4E3A replicas</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Dialector</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db5_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)},</span></span>\n<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">{},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">Address</span><span style="color:#89DDFF;">{}).</span><span style="color:#82AAFF;">Register</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dbresolver</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Config</span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// `db6`\u3001`db7` \u4F5C\u4E3A sources\uFF0C\u5BF9\u4E8E `orders`\u3001`Product` \u4F7F\u7528 `db8` \u4F5C\u4E3A replicas</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Sources</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Dialector</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db6_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db7_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)},</span></span>\n<span class="line"><span style="color:#A6ACCD;">  Replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">gorm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Dialector</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">db8_dsn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)},</span></span>\n<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">orders</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">Product</span><span style="color:#89DDFF;">{},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">secondary</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">))</span></span>\n<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div>',4),e=[o];function r(c,D,t,F,y,A){return a(),n("div",null,e)}const d=s(p,[["render",r]]);export{i as __pageData,d as default};
